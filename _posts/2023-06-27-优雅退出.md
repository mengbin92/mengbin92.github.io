---
layout: post
title: 如何优雅地退出程序 
tags: go
mermaid: false
math: false
---  

当在Linux系统中执行操作时，进程可以通过发送和接收信号与其他进程进行通信。信号是用于通知进程发生特定事件或请求进程采取特定动作的软件中断。  

以下是Linux系统中常见的一些信号及其含义：  

1. **SIGINT (2)**：中断信号，通常由终端用户按下`Ctrl + C`发送给前台进程。该信号用于请求进程终止运行。  
2. **SIGTERM (15)**：终止信号，用于请求进程正常终止。与SIGKILL相比，SIGTERM允许进程在收到信号后完成清理和退出工作。
3. **SIGKILL (9)**：杀死信号，用于强制终止进程。当进程收到此信号时，它将立即终止，不会进行任何清理操作。  
4. **SIGSTOP (19)**：停止信号，用于暂停进程的执行。与SIGKILL不同，SIGSTOP信号可以通过发送SIGCONT信号来恢复进程的执行。  
5. **SIGCONT (18)**：继续信号，用于恢复被SIGSTOP或SIGTSTP信号暂停的进程的执行。  
6. **SIGHUP (1)**：挂起信号，通常由终端关闭或断开连接时发送给前台进程组的所有成员。进程可以选择在收到此信号时重新加载配置文件或重新初始化。  
7. **SIGUSR1 (10)和SIGUSR2 (12)**：用户定义的信号，供应用程序自定义使用。  
8. **SIGCHLD (17)**：子进程信号，父进程接收到此信号表示其子进程已终止或停止。

这些只是Linux系统中一些常见的信号，还有其他信号可以用于特定目的。你可以使用`man`命令以及相关文档来获取更多有关信号的详细信息。  

所以，当需要终止进程时，SIGKILL (信号编号为9) 和 SIGTERM (信号编号为15) 是两个常见的信号，但这两个信号还是有很大不同的：    

1. **SIGKILL (9)**：
   - 作用：SIGKILL信号用于强制终止进程。当进程收到SIGKILL信号时，它将立即被终止，没有机会进行清理或处理善后工作。
   - 影响：SIGKILL信号是一种无法忽略或捕获的信号，因此进程无法阻止其接收或处理。它是最直接、最严厉的终止方式。
   - 使用场景：通常在需要立即终止进程且不允许进程进行任何清理操作的情况下使用。但是，由于它不允许进程进行清理，因此在可以使用其他信号终止进程的情况下，最好先尝试使用其他信号。
2. **SIGTERM (15)**：
   - 作用：SIGTERM信号用于请求进程正常终止。它是一种优雅的终止方式，给予进程完成清理工作的机会。
   - 影响：进程可以捕获SIGTERM信号并编写信号处理程序来在接收到信号时执行自定义的清理操作。进程可以自行决定如何响应SIGTERM信号。
   - 使用场景：当需要结束进程时，首选使用SIGTERM信号。它允许进程在接收到信号后进行必要的资源释放、保存数据或完成其他清理任务。通常，系统管理员或用户可以使用该信号向进程发送终止请求。

总结：SIGKILL是一种立即终止进程的信号，不允许进程进行任何清理操作。而SIGTERM是一种优雅的终止信号，给予进程完成清理工作的机会。在终止进程时，应首先尝试使用SIGTERM，只有在必要时才使用SIGKILL。  

以下是标准的Linux信号，不同的操作系统和版本可能会有所差异：  

| 信号编号 | 信号名称  | 描述                                                           |
| :------- | :-------- | :------------------------------------------------------------- |
| 1        | SIGHUP    | 挂起信号，通常由终端关闭或断开连接时发送给前台进程组的所有成员 |
| 2        | SIGINT    | 中断信号，通常由用户在终端按下`Ctrl + C`发送给前台进程         |
| 3        | SIGQUIT   | 退出信号，通常由用户在终端按下`Ctrl + \`发送给前台进程         |
| 4        | SIGILL    | 非法指令信号，表示进程执行了非法、无效的指令                   |
| 5        | SIGTRAP   | 跟踪陷阱信号，通常由调试器使用                                 |
| 6        | SIGABRT   | 中止信号，由进程自身调用`abort()`函数引发                      |
| 7        | SIGBUS    | 总线错误信号，表示内存访问错误                                 |
| 8        | SIGFPE    | 浮点异常信号，表示浮点运算错误                                 |
| 9        | SIGKILL   | 终止信号，用于立即强制终止进程                                 |
| 10       | SIGUSR1   | 用户定义信号1                                                  |
| 11       | SIGSEGV   | 段错误信号，表示进程访问无效的内存段                           |
| 12       | SIGUSR2   | 用户定义信号2                                                  |
| 13       | SIGPIPE   | 管道破裂信号，表示写入已关闭的管道                             |
| 14       | SIGALRM   | 闹钟信号，由`alarm()`函数或定时器触发                          |
| 15       | SIGTERM   | 终止信号，用于请求进程正常终止                                 |
| 16       | SIGSTKFLT | 协处理器堆栈错误                                               |
| 17       | SIGCHLD   | 子进程信号，父进程接收到此信号表示子进程已终止或停止           |
| 18       | SIGCONT   | 继续信号，用于恢复被暂停的进程的执行                           |
| 19       | SIGSTOP   | 停止信号，用于暂停进程的执行                                   |
| 20       | SIGTSTP   | 终端挂起信号，通常由用户在终端按下`Ctrl + Z`发送给前台进程     |
| 21       | SIGTTIN   | 后台进程读终端信号                                             |
| 22       | SIGTTOU   | 后台进程写终端信号                                             |
| 23       | SIGURG    | 紧急事件信号                                                   |
| 24       | SIGXCPU   | 超过CPU时间限制信号                                            |
| 25       | SIGXFSZ   | 文件大小超过限制信号                                           |
| 26       | SIGVTALRM | 虚拟定时器信号                                                 |
| 27       | SIGPROF   | 进程定时器信号                                                 |
| 28       | SIGWINCH  | 窗口大小改变信号                                               |
| 29       | SIGIO     | 异步I/O事件信号                                                |
| 30       | SIGPWR    | 电源故障信号                                                   |
| 31       | SIGSYS    | 非法系统调用信号                                               |

---

<div align="center">
  <img src="../img/qrcode_wechat.jpg" alt="孟斯特">
</div>

> 声明：本作品采用[署名-非商业性使用-相同方式共享 4.0 国际 (CC BY-NC-SA 4.0)](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh)进行许可，使用时请注明出处。  
> Author: [mengbin](mengbin1992@outlook.com)  
> blog: [mengbin](https://mengbin.top)  
> Github: [mengbin92](https://mengbin92.github.io/)  
> cnblogs: [恋水无意](https://www.cnblogs.com/lianshuiwuyi/)  

---
