---
layout: post
title: 常见国密算法简介
tags: 密码学
mermaid: false
math: false
---  

## SM2

SM2 国密SM2算法是中国国家密码管理局（CNCA）发布的一种非对称加密算法。它采用椭圆曲线密码体系（Elliptic Curve Cryptography，ECC）进行密钥交换、数字签名和公钥加密等操作。以下是SM2算法的主要特点和步骤：

**特点：**

1. **安全性高：** SM2基于椭圆曲线离散对数难题（ECDLP），在相对较短的密钥长度下提供了较高的安全性。
2. **效率高：** 相比传统RSA算法，SM2在相同安全级别下使用更短的密钥长度，从而提高了加密和解密的速度。
3. **国际标准：** SM2已经成为中国国家标准和行业标准，逐渐在各种安全应用中得到广泛应用。

**算法步骤：**

1. **密钥生成：** 首先，选择一个椭圆曲线和基点。然后，用户随机生成一个私钥（d），并计算公钥（Q = d * G，G为基点）。
2. **数字签名：**
   - a. 生成随机数k（1 < k < n-1，n为椭圆曲线的阶）。
   - b. 计算椭圆曲线点（x1，y1）= k * G。
   - c. 计算r = x1 mod n，若r为0则重新选择k。
   - d. 计算s = ((hash(m) + r * d) * k^(-1)) mod n，若s为0则重新选择k。
   - e. 数字签名为（r，s）。
3. **签名验证：**
   - a. 计算t = (r + s) mod n，若t为0则签名无效。
   - b. 计算椭圆曲线点（x1，y1）= (s^-1 * t) * G + (s^-1 * r) * Q。
   - c. 验证r是否等于x1 mod n，若相等则签名有效。

## SM3

SM3 国密SM3算法是中国国家密码管理局（国密局）发布的密码学算法标准之一，用于数据完整性校验和消息摘要计算。以下是SM3算法的详细介绍：

1. SM3基本特点：
   - 哈希函数：SM3是一种密码学哈希函数，用于将任意长度的输入数据映射为固定长度（256位或32字节）的消息摘要。
   - 安全性：SM3被设计为具有强安全性，抵抗各种常见的密码分析攻击，包括碰撞攻击和预像攻击。
   - 国密标准：SM3是中国国家密码管理局发布的密码学算法标准之一，用于政府和企业的信息安全应用。
   - 固定输出：SM3的输出是固定长度的，不管输入数据的大小，始终生成相同长度的摘要。
2. SM3算法结构：
   - SM3算法采用Merkle–Damgård结构，将输入数据划分为一系列数据块，然后分别处理每个数据块。
   - 算法包括轮函数、置换、非线性函数和循环移位等操作，这些操作被多轮迭代执行，以增强安全性。
3. SM3的安全性：
   - SM3经过广泛的密码分析和评估，被认为在当前技术水平下是安全的，可以用于保护敏感信息。
   - 它抵抗了碰撞攻击，即找到两个不同的输入，产生相同的摘要的攻击。
   - 它也抵御了预像攻击，即从摘要中还原出原始输入的攻击。
4. 应用领域：
   - SM3广泛用于数字签名、消息认证码、SSL/TLS协议、电子商务、电子证书等安全应用领域，特别是在中国的国内应用中。

## SM4

SM4 国密SM4算法，全称《SM4分组密码算法》，是中国国家密码管理局（国家密码局）发布的一种分组密码算法，用于数据加密和解密。以下是对SM4算法的详细介绍：

1. **算法类型**：
   - SM4是一种分组密码算法，它对数据进行分块加密，每个数据块通常为128位（16字节）。
2. **基本特点**：
   - SM4是一种对称密码算法，同一个密钥用于加密和解密。
   - 算法具有固定的轮数，通常为32轮，每轮包含多个步骤。
   - SM4使用S盒、置换、按位异或等运算来混淆数据。
3. **密钥长度**：
   - SM4支持密钥长度为128位（16字节），但可以通过扩展密钥来支持更长的密钥。
4. **加密过程**：
   - 明文被分成多个块，每个块与一个轮密钥进行一系列的操作。
   - 这些操作包括S盒替代、线性变换、轮密钥的按位异或等。
   - 这个过程在多轮中重复执行，通常为32轮。
5. **解密过程**：
   - 解密过程与加密过程类似，但轮密钥的顺序与加密过程相反，从最后一轮开始逐渐恢复明文。
6. **安全性**：
   - SM4算法经过了广泛的安全性分析和审查，被认为是安全的分组密码算法。
   - 它的安全性与密钥长度和轮数等因素有关。
7. **应用领域**：
   - SM4算法在中国国内被广泛用于数据加密、电子认证、物联网设备安全等领域。
   - 由于其开放性，也在国际上受到一定关注。
8. **标准化**：
   - SM4算法已经被国际电信联盟（ITU-T）接受为国际标准，具体标准为ITU-T X.1035。

## SM9

SM9 国密SM9算法是中国自主研发的密码算法，旨在提供安全的数字签名和加密机制。以下是对SM9算法的详细介绍：

1. **背景**：
   - SM9算法是中国密码领域的国产密码算法，由中国密码行业研究员共同开发。
   - 它主要用于数字签名、密钥交换和加密通信。
2. **SM9算法的特点**：
   - **国密标准**：SM9算法是中国国家密码管理局发布的国家密码标准之一。
   - **椭圆曲线密码**：SM9基于椭圆曲线密码学，使用椭圆曲线上的点来实现安全操作。
   - **支持多种密码操作**：它支持数字签名、密钥协商和加密操作，使其适用于多种安全通信场景。
   - **高度安全性**：SM9提供了较高的密码强度，抵御了多种密码分析攻击。
3. **SM9算法的主要组成部分**：
   - **椭圆曲线参数**：SM9使用特定的椭圆曲线参数来实现加密和签名操作。
   - **密钥生成**：用户生成自己的密钥对，包括私钥和公钥。
   - **数字签名**：SM9允许用户使用私钥对数据进行签名，验证签名时使用对应的公钥。
   - **密钥协商**：两方可以使用各自的私钥协商出一个共享密钥，用于后续的加密通信。
   - **加密和解密**：SM9支持使用共享密钥进行对称加密和解密操作。
4. **应用领域**：
   - SM9广泛应用于数字身份验证、电子合同、数据加密、安全通信等领域，特别适用于中国国内的加密通信需求。

## 祖冲之（ZUC）算法

祖冲之算法（ZUC算法）是一种流密码算法，由中国国家密码管理局发布的国密密码算法之一。流密码算法用于生成伪随机密钥流，该密钥流然后与明文数据进行异或操作，从而实现数据的加密和解密。下面是关于祖冲之算法的详细介绍：

1. **算法名称**：祖冲之算法的名称来源于中国古代数学家祖冲之（Zu Chongzhi），以纪念他的数学成就。
2. **流密码算法**：祖冲之算法是一种流密码算法，它生成伪随机密钥流。这个密钥流与明文数据进行逐位异或操作，以实现数据的加密和解密。
3. **密钥**：祖冲之算法使用一个64位的密钥，这个密钥是用于生成密钥流的种子。密钥的保密性对算法的安全性非常重要。
4. **密钥流生成**：祖冲之算法使用密钥和初始化向量（IV）来生成伪随机的密钥流。这个密钥流的生成是算法的核心。密钥流的质量和随机性对算法的安全性至关重要。
5. **逐位异或**：生成的密钥流与明文数据逐位异或，以实现加密。在解密时，相同的密钥流再次与密文数据逐位异或，以还原原始明文。
6. **安全性**：祖冲之算法被设计成具有较高的安全性，能够抵抗各种密码分析攻击，包括差分攻击和线性攻击。它也经过了多轮的密码学审查和测试，以确保其安全性。
7. **应用领域**：祖冲之算法最初设计用于移动通信领域，如3G和4G网络的数据加密。它用于保护通信的隐私和数据安全。然而，它也可以应用于其他需要流密码的场景。
8. **国密标准**：祖冲之算法是中国国家密码管理局发布的国密密码算法标准之一。这意味着在中国境内，使用祖冲之算法通常需要遵守相关的国家法规和政策。

以下是祖冲之算法的一些常见部分：

1. SM4：祖冲之算法的对称加密部分采用SM4，它是一种分组密码算法，支持128位密钥和128位分组大小。SM4使用多轮的替代-置换网络结构来加密数据，以保护机密信息的安全性。它在各种应用中广泛使用，包括数据加密和身份验证。
2. SM3：祖冲之算法的哈希算法部分采用SM3，它是一种密码学哈希函数，用于生成数据的固定长度哈希值。SM3支持256位哈希值，通常用于验证数据的完整性和安全性。它在数字签名、消息认证码等领域得到广泛应用。
3. 密钥管理：国密算法要求严格的密钥管理和保护。密钥的生成、存储和分发都需要受到高度保护，以确保数据的机密性和完整性。
4. 国际标准：尽管国密算法最初是为中国国内使用而设计的，但一些国际标准组织已经考虑将其纳入国际标准，以促进国际信息安全合作。

---

<div align="center">
  <img src="../img/qrcode_wechat.jpg" alt="孟斯特">
</div>

> 声明：本作品采用[署名-非商业性使用-相同方式共享 4.0 国际 (CC BY-NC-SA 4.0)](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh)进行许可，使用时请注明出处。  
> Author: [mengbin](mengbin1992@outlook.com)  
> blog: [mengbin](https://mengbin.top)  
> Github: [mengbin92](https://mengbin92.github.io/)  
> cnblogs: [恋水无意](https://www.cnblogs.com/lianshuiwuyi/)  

---
